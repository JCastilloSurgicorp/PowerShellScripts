SELECT TOP 8000 * FROM [dbo].[USR_STRMVK]
--WHERE STRMVK_STOCKS > 0
WHERE STRMVK_ARTCOD = '130-408/05B'
ORDER BY STRMVK_NOTROS

SELECT * FROM [dbo].[USR_STMPDH]
ORDER BY STMPDH_ARTCOD

SELECT * FROM [dbo].[STOCK_INVENTARIO]
SELECT * FROM [dbo].[SI_DESCRIPCION]
SELECT * FROM [dbo].[SI_DEPOSITO]
SELECT * FROM [dbo].[SI_TIPOALMACEN]
SELECT * FROM [dbo].[SI_GRUPO]
ORDER BY NOMBRE_GRUPO
SELECT * FROM [dbo].[SI_LINEA]
SELECT * FROM [dbo].[SI_SECTOR]
SELECT * FROM [dbo].[SI_TIPOPRODUCTO]
SELECT * FROM [dbo].[SI_KITS_prod_id]
SELECT * FROM [dbo].[SI_KITS]
SELECT * FROM [dbo].[SI_PRODUCTO_tp_id]
WHERE si_producto_id = 3091
ORDER BY si_producto_id
SELECT * FROM [dbo].[SI_PROVEEDOR]

-- Consultas a SI Productos
SELECT * FROM [dbo].[SI_PRODUCTO]
WHERE CODIGO_PRODUCTO = 'DT000100'

--DELETE FROM [SI_PRODUCTO] WHERE id = 3091 GUIA_DIGEMID --5104  5750 1922 7026       5794 4047
--DBCC CHECKIDENT('SI_PRODUCTO_tp_id', RESEED, 0)
--INSERT INTO SI_PRODUCTO (CODIGO_PRODUCTO, DESCRIPCION)
SELECT TRIM(STRMVK_ARTCOD) As cod, STRMVK_DESART, COUNT(STRMVK_CANTID) as cant FROM [dbo].[USR_STRMVK]
LEFT JOIN [SI_PRODUCTO] as p ON TRIM(STRMVK_ARTCOD) = p.CODIGO_PRODUCTO
WHERE p.CODIGO_PRODUCTO is NULL
GROUP BY TRIM(STRMVK_ARTCOD), STRMVK_DESART
ORDER BY TRIM(STRMVK_ARTCOD)

--SELECT * FROM (
--	SELECT i.cod, COUNT(i.cod) as c FROM (
		INSERT INTO [STOCK_INVENTARIO] (MEDIDA, PRODUCTO_ID, LINEA_ID, GRUPO_ID, PROVEEDOR_ID) 
		SELECT DISTINCT TRIM(STRMVK_ARTCOD) as cod, p.id as p_id, COUNT(STRMVK_STOCKS) as stock, STRMVK_LINEAD, l.id as l_id, STRMVK_GRUPOD, g.id as g_id, STRMVK_NOMPRO, v.id as prov_id FROM [dbo].[USR_STRMVK]
		LEFT JOIN [SI_PRODUCTO] as p ON STRMVK_ARTCOD = p.CODIGO_PRODUCTO
		LEFT JOIN [dbo].[SI_LINEA] as l ON STRMVK_LINEAD = l.NOMBRE_LINEA
		LEFT JOIN [dbo].[SI_GRUPO] as g ON STRMVK_GRUPOD = g.NOMBRE_GRUPO
		LEFT JOIN [dbo].[SI_PROVEEDOR] as v ON STRMVK_NOMPRO = v.NOMBRE_PROVEEDOR
		WHERE STRMVK_STOCKS > 0
		--WHERE STRMVK_ARTCOD = '1749' --and p.id is not NULL
		GROUP BY TRIM(STRMVK_ARTCOD), p.id, STRMVK_LINEAD, l.id, STRMVK_GRUPOD, g.id, STRMVK_NOMPRO, v.id
		ORDER BY stock
--	) as i
--	GROUP BY i.cod
--) as c
--WHERE c.c > 1

SELECT TRIM(STRMVK_ARTCOD), COUNT(STRMVK_STOCKS) FROM [dbo].[USR_STRMVK]
--WHERE STRMVK_ARTCOD = 'MF14-2309' --196RD6CL1  236ST202 253RD3CL1 1749
GROUP BY TRIM(STRMVK_ARTCOD)
ORDER BY TRIM(STRMVK_ARTCOD)
